<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vehicle Diagnostic Pipeline v6.0</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      margin: 0;
    }
  </style>
</head>

<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState } = React;

    const Arrow = () => (
      <div className="flex justify-center py-1">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#475569" strokeWidth="2">
          <path d="M12 5v14M5 12l7 7 7-7" />
        </svg>
      </div>
    );

    const ValidationBadge = ({ status }) => {
      const styles = {
        validated: 'bg-green-500/20 text-green-400 border-green-500/50',
        partial: 'bg-yellow-500/20 text-yellow-400 border-yellow-500/50',
        unvalidated: 'bg-slate-500/20 text-slate-400 border-slate-500/50',
        new: 'bg-purple-500/20 text-purple-400 border-purple-500/50',
      };
      const labels = {
        validated: '‚úì Validated',
        partial: '‚óê Partial',
        unvalidated: '‚óã Pending',
        new: '‚òÖ New',
      };
      return (
        <span className={`text-xs px-2 py-0.5 rounded border ${styles[status]}`}>
          {labels[status]}
        </span>
      );
    };

    const TypeBadge = ({ type }) => {
      const styles = {
        neural: 'bg-purple-500/20 text-purple-300',
        symbolic: 'bg-green-500/20 text-green-300',
        hybrid: 'bg-blue-500/20 text-blue-300',
        physics: 'bg-orange-500/20 text-orange-300',
      };
      return type ? (
        <span className={`text-xs px-2 py-0.5 rounded ${styles[type]}`}>
          {type.charAt(0).toUpperCase() + type.slice(1)}
        </span>
      ) : null;
    };

    const LLMBadge = ({ enabled }) => {
      return enabled ? (
        <span className="text-xs px-2 py-0.5 rounded bg-gradient-to-r from-pink-500/30 to-purple-500/30 text-pink-300 border border-pink-500/50 animate-pulse">
          ‚ú® LLM
        </span>
      ) : null;
    };

    // Executive View - Simple flow with current results
    const ExecutiveView = () => {
      const stages = [
        { n: '0', title: 'Data Sources', desc: 'YouTube Audio (2733) + Synthetic Vibration (6600) + OBD', validation: 'validated', note: 'Multi-modal' },
        { n: '1', title: 'Synthetic Pre-training', desc: 'Physics-based vibration: 22 faults √ó 7 engines √ó scenarios', validation: 'new', note: '63.9% (22-class)', physics: true },
        { n: '2', title: 'Audio Encoding', desc: 'AST (768d) + CLAP multi-scale (3072d) = 3840d', validation: 'validated', note: '52.4% (11-class)' },
        { n: '2.5', title: 'Feature Fusion', desc: 'PCA 512 ‚Üí SVM RBF classification', validation: 'validated', note: 'Best config' },
        { n: '3', title: 'Evidence Extraction', desc: '11-class symptoms + anomaly score (AUC=0.777)', validation: 'validated', note: 'AST+CLAP' },
        { n: '4', title: 'Knowledge Graph Query', desc: 'Fault KB ‚Üí candidate hypotheses (22 vibration + 8 OBD faults)', validation: 'validated', note: '30 fault types' },
        { n: '5', title: 'Deductive Filtering', desc: 'Physics constraints eliminate impossible faults', validation: 'validated', note: '100% Precision' },
        { n: '6', title: 'Abductive Ranking', desc: 'Evidence-Weighted Bayesian Scoring', validation: 'validated', note: 'Recall@3: 84.2%' },
        { n: '7', title: 'Output', desc: 'Diagnosis + LLM Explanation + Actions', validation: 'validated', note: 'LLM Report', llm: true },
      ];

      return (
        <div className="space-y-1">
          {/* Current Results Summary */}
          <div className="bg-gradient-to-r from-green-900/30 to-blue-900/30 rounded-lg p-3 mb-4 border border-green-500/30">
            <div className="text-green-400 font-bold text-sm mb-2">Current Best Results (2026-01-28)</div>
            <div className="grid grid-cols-3 gap-3 text-xs">
              <div className="bg-slate-900/50 rounded p-2 text-center">
                <div className="text-2xl font-bold text-orange-400">63.9%</div>
                <div className="text-slate-400">Vibration Encoder</div>
                <div className="text-slate-500">(22 faults, physics-corrected)</div>
              </div>
              <div className="bg-slate-900/50 rounded p-2 text-center">
                <div className="text-2xl font-bold text-cyan-400">52.4%</div>
                <div className="text-slate-400">Audio Classification</div>
                <div className="text-slate-500">(11-class, quality-verified)</div>
              </div>
              <div className="bg-slate-900/50 rounded p-2 text-center">
                <div className="text-2xl font-bold text-purple-400">0.777</div>
                <div className="text-slate-400">Anomaly AUC</div>
                <div className="text-slate-500">(AST+CLAP Ensemble)</div>
              </div>
            </div>
          </div>

          {stages.map((s, i) => (
            <div key={i}>
              <div className={`rounded-lg p-3 flex items-center justify-between ${s.llm ? 'bg-gradient-to-r from-slate-800/50 to-pink-900/20 border border-pink-500/30' : s.physics ? 'bg-gradient-to-r from-slate-800/50 to-orange-900/20 border border-orange-500/30' : 'bg-slate-800/50'}`}>
                <div className="flex items-center gap-3">
                  <span className="bg-slate-700 text-slate-300 text-xs font-bold w-6 h-6 rounded flex items-center justify-center">{s.n}</span>
                  <div>
                    <div className="text-white font-medium text-sm flex items-center gap-2">
                      {s.title}
                      <LLMBadge enabled={s.llm} />
                    </div>
                    <div className="text-slate-400 text-xs">{s.desc}</div>
                  </div>
                </div>
                <div className="flex items-center gap-2">
                  {s.note && <span className={`text-xs ${s.llm ? 'text-pink-400' : s.physics ? 'text-orange-400' : 'text-green-400'}`}>{s.note}</span>}
                  <ValidationBadge status={s.validation} />
                </div>
              </div>
              {i < stages.length - 1 && <Arrow />}
            </div>
          ))}
        </div>
      );
    };

    // Vibration Pre-training View - NEW
    const VibrationView = () => {
      return (
        <div className="space-y-4 text-xs">
          <div className="text-center text-slate-400 mb-4">
            Synthetic Vibration Pre-training Pipeline (Physics-First Approach)
          </div>

          {/* Why Vibration First */}
          <div className="bg-gradient-to-r from-orange-900/30 to-yellow-900/30 rounded-lg p-4 border border-orange-500/50">
            <div className="text-orange-400 font-bold mb-2">Why Synthetic Vibration as Anchor Modality?</div>
            <div className="grid grid-cols-2 gap-3">
              <div className="bg-slate-900/50 rounded p-2">
                <div className="text-green-400 font-semibold">Advantages</div>
                <div className="text-slate-400 mt-1">
                  <div>‚Ä¢ Physics is deterministic & well-understood</div>
                  <div>‚Ä¢ Unlimited labeled training data</div>
                  <div>‚Ä¢ Same fault signatures in both modalities</div>
                  <div>‚Ä¢ No recording quality issues</div>
                </div>
              </div>
              <div className="bg-slate-900/50 rounded p-2">
                <div className="text-cyan-400 font-semibold">Transfer Path</div>
                <div className="text-slate-400 mt-1">
                  <div>‚Ä¢ Engine block = cast iron/aluminum</div>
                  <div>‚Ä¢ Same resonance modes appear in audio</div>
                  <div>‚Ä¢ Different transfer functions only</div>
                  <div>‚Ä¢ Shared embedding space enables transfer</div>
                </div>
              </div>
            </div>
          </div>

          {/* 22 Fault Types */}
          <div className="bg-slate-900 rounded-lg p-4 border border-slate-700">
            <div className="text-yellow-400 font-bold mb-3">22 Fault Types (OBD Cannot Detect!)</div>
            <div className="grid grid-cols-5 gap-2">
              <div className="bg-red-900/20 border border-red-500/30 rounded p-2">
                <div className="text-red-400 font-semibold text-xs mb-1">Engine Internal (8)</div>
                <div className="text-slate-400 text-xs space-y-0.5">
                  <div>‚Ä¢ rod_bearing (3 stages)</div>
                  <div>‚Ä¢ main_bearing</div>
                  <div>‚Ä¢ piston_slap</div>
                  <div>‚Ä¢ vanos_rattle</div>
                  <div>‚Ä¢ timing_chain</div>
                  <div>‚Ä¢ valvetrain_tick</div>
                </div>
                <div className="text-red-300 text-xs mt-1">$10-20k engine</div>
              </div>
              <div className="bg-blue-900/20 border border-blue-500/30 rounded p-2">
                <div className="text-blue-400 font-semibold text-xs mb-1">Accessory (5)</div>
                <div className="text-slate-400 text-xs space-y-0.5">
                  <div>‚Ä¢ water_pump</div>
                  <div>‚Ä¢ alternator</div>
                  <div>‚Ä¢ ac_compressor</div>
                  <div>‚Ä¢ power_steering</div>
                  <div>‚Ä¢ belt_tensioner</div>
                </div>
                <div className="text-blue-300 text-xs mt-1">Stranded risk</div>
              </div>
              <div className="bg-purple-900/20 border border-purple-500/30 rounded p-2">
                <div className="text-purple-400 font-semibold text-xs mb-1">Turbo (3)</div>
                <div className="text-slate-400 text-xs space-y-0.5">
                  <div>‚Ä¢ turbo_bearing</div>
                  <div>‚Ä¢ wastegate_rattle</div>
                  <div>‚Ä¢ boost_leak</div>
                </div>
                <div className="text-purple-300 text-xs mt-1">$3-8k turbo</div>
              </div>
              <div className="bg-green-900/20 border border-green-500/30 rounded p-2">
                <div className="text-green-400 font-semibold text-xs mb-1">Drivetrain (3)</div>
                <div className="text-slate-400 text-xs space-y-0.5">
                  <div>‚Ä¢ wheel_bearing</div>
                  <div>‚Ä¢ cv_joint</div>
                  <div>‚Ä¢ differential</div>
                </div>
                <div className="text-green-300 text-xs mt-1">SAFETY!</div>
              </div>
              <div className="bg-orange-900/20 border border-orange-500/30 rounded p-2">
                <div className="text-orange-400 font-semibold text-xs mb-1">Exhaust (2)</div>
                <div className="text-slate-400 text-xs space-y-0.5">
                  <div>‚Ä¢ exhaust_leak</div>
                  <div>‚Ä¢ heat_shield</div>
                </div>
                <div className="text-orange-300 text-xs mt-1">Fire risk</div>
              </div>
            </div>
          </div>

          {/* Physics Model */}
          <div className="bg-green-900/20 rounded-lg p-4 border border-green-500/50">
            <div className="text-green-400 font-bold mb-3">Physics Model (Corrected 2026-01-28)</div>
            <div className="grid grid-cols-2 gap-3">
              <div className="bg-slate-900 rounded p-2">
                <div className="text-yellow-400 font-semibold mb-2">Journal Bearing Physics (CORRECTED)</div>
                <div className="text-slate-400 text-xs">
                  <div className="text-red-400">OLD (Wrong): Ball-pass frequencies (BPFO/BPFI)</div>
                  <div className="text-green-400 mt-1">NEW (Correct):</div>
                  <div>‚Ä¢ Rod bearing: Crank-angle-locked at 15¬∞ after TDC</div>
                  <div>‚Ä¢ Main bearing: 1√ó order at combined load peaks</div>
                  <div>‚Ä¢ Oil whirl: 0.43√ó shaft speed (severe only)</div>
                </div>
              </div>
              <div className="bg-slate-900 rounded p-2">
                <div className="text-cyan-400 font-semibold mb-2">Realistic Baseline Physics</div>
                <div className="text-slate-400 text-xs">
                  <div>‚Ä¢ Cylinder-by-cylinder combustion pulses</div>
                  <div>‚Ä¢ Cycle-to-cycle variability (CoV 5-12%)</div>
                  <div>‚Ä¢ Torsional vibration harmonics</div>
                  <div>‚Ä¢ Piston secondary motion (2√ó order)</div>
                  <div>‚Ä¢ Temperature effects (cold = 1.8√ó worse)</div>
                </div>
              </div>
            </div>
          </div>

          {/* Engine Configurations */}
          <div className="bg-blue-900/20 rounded-lg p-4 border border-blue-500/50">
            <div className="text-blue-400 font-bold mb-3">7 Engine Configurations</div>
            <div className="grid grid-cols-7 gap-1 text-center">
              {['I4', 'I4-CI', 'I6', 'V6-60', 'V6-90', 'V8', 'V8-CI'].map((eng, i) => (
                <div key={i} className="bg-slate-900 rounded p-2">
                  <div className="text-cyan-300 font-semibold">{eng}</div>
                  <div className="text-slate-500 text-xs">{['2nd', '2nd', '3rd', '3rd', '3rd', '4th', '4th'][i]} order</div>
                </div>
              ))}
            </div>
            <div className="mt-2 text-slate-400 text-xs">
              Material properties: Aluminum (light, high-freq) vs Cast Iron (heavy, damped)
            </div>
          </div>

          {/* Dataset & Results */}
          <div className="bg-purple-900/20 rounded-lg p-4 border border-purple-500/50">
            <div className="text-purple-400 font-bold mb-3">Training Results</div>
            <div className="grid grid-cols-2 gap-3">
              <div className="bg-slate-900 rounded p-2">
                <div className="text-orange-400 font-semibold mb-2">Original Dataset (1.35 GB)</div>
                <div className="text-slate-400 text-xs">
                  <div>‚Ä¢ 6,600 signals (3 engines √ó 22 faults √ó 50 √ó 2)</div>
                  <div>‚Ä¢ Fixed RPM, simpler physics</div>
                  <div className="text-green-400 mt-1">Test Accuracy: 81.9%</div>
                  <div className="text-slate-500">(Easier signals)</div>
                </div>
              </div>
              <div className="bg-slate-900 rounded p-2 border border-green-500/30">
                <div className="text-green-400 font-semibold mb-2">V2 Physics-Corrected (2.7 GB) ‚≠ê</div>
                <div className="text-slate-400 text-xs">
                  <div>‚Ä¢ 6,600 signals (3 eng √ó 5 scenarios √ó 22 √ó 2 √ó 10)</div>
                  <div>‚Ä¢ Time-varying RPM, correct physics</div>
                  <div className="text-yellow-400 mt-1">Test Accuracy: 63.9%</div>
                  <div className="text-slate-500">(Realistic = harder but better transfer)</div>
                </div>
              </div>
            </div>
          </div>

          {/* Per-Class Results */}
          <div className="bg-slate-900 rounded-lg p-4 border border-slate-700">
            <div className="text-slate-300 font-bold mb-3">Safety-Critical Fault Detection</div>
            <div className="grid grid-cols-3 gap-2">
              {[
                { fault: 'wheel_bearing', acc: '100%', risk: 'Wheel separation' },
                { fault: 'turbo_bearing', acc: '100%', risk: 'Engine damage' },
                { fault: 'differential', acc: '100%', risk: 'Drivetrain failure' },
                { fault: 'main_bearing', acc: '96.5%', risk: 'Engine seizure' },
                { fault: 'rod_severe', acc: '92.1%', risk: 'Catastrophic' },
                { fault: 'cv_joint', acc: '85.7%', risk: 'Drivetrain failure' },
              ].map((f, i) => (
                <div key={i} className="bg-green-900/20 border border-green-500/30 rounded p-2 text-center">
                  <div className="text-green-400 font-mono text-xs">{f.fault}</div>
                  <div className="text-2xl font-bold text-white">{f.acc}</div>
                  <div className="text-red-400 text-xs">{f.risk}</div>
                </div>
              ))}
            </div>
          </div>
        </div>
      );
    };

    // Audio Classification View
    const AudioView = () => {
      return (
        <div className="space-y-4 text-xs">
          <div className="text-center text-slate-400 mb-4">
            Audio Classification Pipeline (Foundation Models)
          </div>

          {/* Audio Processing Chain */}
          <div className="bg-cyan-900/20 rounded-lg p-4 border border-cyan-500/50">
            <div className="text-cyan-400 font-bold mb-3">Audio Processing Pipeline</div>
            <div className="bg-slate-900 rounded p-3 font-mono text-slate-400">
              <div>Raw Audio (wav) ‚Üí Resample to 48kHz ‚Üí Mono</div>
              <div className="text-slate-500 mt-1">‚Üì</div>
              <div className="text-cyan-300">AST Encoder (16kHz) ‚Üí 768-dim embedding</div>
              <div className="text-pink-300">CLAP Multi-scale (3s, 5s, 7s) ‚Üí 3072-dim</div>
              <div className="text-slate-500 mt-1">‚Üì</div>
              <div className="text-yellow-300">Combined: 3840-dim ‚Üí PCA 512 (93.9% variance)</div>
              <div className="text-slate-500 mt-1">‚Üì</div>
              <div className="text-green-300">SVM RBF Classifier ‚Üí 11 classes</div>
            </div>
          </div>

          {/* Dataset Stats */}
          <div className="bg-green-900/20 rounded-lg p-4 border border-green-500/50">
            <div className="text-green-400 font-bold mb-3">Dataset: 2,733 Samples (Quality-Verified)</div>
            <div className="grid grid-cols-2 gap-3">
              <div className="bg-slate-900 rounded p-2">
                <div className="text-orange-400 font-semibold mb-2">Fault Samples: 2,304</div>
                <div className="text-slate-400 text-xs space-y-0.5">
                  <div>tick: 419 | rattle: 341 | whine: 322</div>
                  <div>knock: 269 | misfire: 224 | grind: 199</div>
                  <div>hiss: 178 | clunk: 152 | squeal: 117</div>
                  <div>wheel_bearing: 83</div>
                </div>
              </div>
              <div className="bg-slate-900 rounded p-2">
                <div className="text-cyan-400 font-semibold mb-2">Healthy Samples: 429</div>
                <div className="text-slate-400 text-xs">
                  <div>healthy_idle: 201</div>
                  <div>healthy_revving: 228</div>
                </div>
                <div className="text-green-400 mt-2 text-xs">Quality: Freesound outliers removed</div>
              </div>
            </div>
          </div>

          {/* Per-Class Results */}
          <div className="bg-purple-900/20 rounded-lg p-4 border border-purple-500/50">
            <div className="text-purple-400 font-bold mb-3">V15 Per-Class Accuracy (52.4% overall)</div>
            <div className="grid grid-cols-4 gap-2">
              {[
                { cls: 'healthy', acc: 80, color: 'green' },
                { cls: 'misfire', acc: 53, color: 'cyan' },
                { cls: 'rattle', acc: 50, color: 'blue' },
                { cls: 'knock', acc: 48, color: 'yellow' },
                { cls: 'wheel_bearing', acc: 46, color: 'orange' },
                { cls: 'tick', acc: 45, color: 'pink' },
                { cls: 'whine', acc: 42, color: 'purple' },
                { cls: 'hiss', acc: 37, color: 'slate' },
                { cls: 'clunk', acc: 33, color: 'red' },
                { cls: 'squeal', acc: 33, color: 'red' },
                { cls: 'grind', acc: 32, color: 'red' },
              ].map((c, i) => (
                <div key={i} className="bg-slate-900 rounded p-2">
                  <div className="flex justify-between items-center">
                    <span className="text-slate-300">{c.cls}</span>
                    <span className={`font-bold ${c.acc >= 50 ? 'text-green-400' : c.acc >= 40 ? 'text-yellow-400' : 'text-red-400'}`}>{c.acc}%</span>
                  </div>
                  <div className="mt-1 h-1 bg-slate-700 rounded">
                    <div className={`h-1 rounded ${c.acc >= 50 ? 'bg-green-500' : c.acc >= 40 ? 'bg-yellow-500' : 'bg-red-500'}`} style={{width: `${c.acc}%`}}></div>
                  </div>
                </div>
              ))}
            </div>
          </div>

          {/* Sound Taxonomy */}
          <div className="bg-yellow-900/20 rounded-lg p-4 border border-yellow-500/50">
            <div className="text-yellow-400 font-bold mb-3">11-Class Sound Taxonomy</div>
            <div className="grid grid-cols-3 gap-2">
              <div className="bg-red-900/20 border border-red-500/30 rounded p-2">
                <div className="text-red-400 font-semibold text-xs mb-1">Impulsive</div>
                <div className="text-slate-400 text-xs">
                  <div>knock - heavy impacts</div>
                  <div>tick - rapid clicking</div>
                  <div>clunk - single thuds</div>
                </div>
              </div>
              <div className="bg-blue-900/20 border border-blue-500/30 rounded p-2">
                <div className="text-blue-400 font-semibold text-xs mb-1">Tonal</div>
                <div className="text-slate-400 text-xs">
                  <div>whine - gear/bearing tone</div>
                  <div>squeal - high-pitch friction</div>
                  <div>misfire - rough pulsing</div>
                </div>
              </div>
              <div className="bg-green-900/20 border border-green-500/30 rounded p-2">
                <div className="text-green-400 font-semibold text-xs mb-1">Noise/Broadband</div>
                <div className="text-slate-400 text-xs">
                  <div>rattle - loose parts</div>
                  <div>hiss - air/fluid escape</div>
                  <div>grind - metal-on-metal</div>
                </div>
              </div>
            </div>
            <div className="mt-2 bg-slate-900/50 rounded p-2 text-center">
              <span className="text-cyan-400">+ healthy</span> <span className="text-slate-400">|</span> <span className="text-orange-400">+ wheel_bearing</span>
            </div>
          </div>

          {/* Experiment History */}
          <div className="bg-slate-900 rounded-lg p-4 border border-slate-700">
            <div className="text-slate-300 font-bold mb-3">Experiment Leaderboard</div>
            <div className="space-y-1">
              {[
                { exp: 'AST+CLAP (v15, quality-verified)', acc: '52.4%', best: true },
                { exp: 'AST+CLAP (v13, expanded)', acc: '51.3%', best: false },
                { exp: 'AST+CLAP (v11, cleaned)', acc: '48.3%', best: false },
                { exp: 'AST+CLAP (v9, +Freesound)', acc: '42.8%', best: false },
                { exp: 'CED + AST+CLAP (PCA 256)', acc: '45.6%', best: false },
                { exp: 'PANNs CNN14 (PCA 512)', acc: '38.5%', best: false },
                { exp: 'AudioMAE (PCA 512)', acc: '31.8%', best: false },
              ].map((e, i) => (
                <div key={i} className={`flex justify-between p-2 rounded ${e.best ? 'bg-green-900/30 border border-green-500/50' : 'bg-slate-800/50'}`}>
                  <span className={e.best ? 'text-green-400' : 'text-slate-400'}>{e.exp}</span>
                  <span className={`font-bold ${e.best ? 'text-green-400' : 'text-slate-500'}`}>{e.acc}</span>
                </div>
              ))}
            </div>
          </div>
        </div>
      );
    };

    // Pipeline View - Detailed stage breakdown
    const PipelineView = () => {
      const [expanded, setExpanded] = useState(null);

      const stages = [
        {
          n: '0', title: 'Data Sources', type: 'hybrid', validation: 'validated',
          content: (
            <div className="grid grid-cols-3 gap-2 text-xs">
              <div className="bg-orange-900/30 border border-orange-500/50 rounded p-2 text-center">
                <div className="text-2xl">üì≥</div>
                <div className="text-orange-400 font-medium">Synthetic Vibration</div>
                <div className="text-slate-400">6,600 signals</div>
                <div className="text-slate-500">Physics-based</div>
              </div>
              <div className="bg-cyan-900/30 border border-cyan-500/50 rounded p-2 text-center">
                <div className="text-2xl">üé§</div>
                <div className="text-cyan-400 font-medium">YouTube Audio</div>
                <div className="text-slate-400">2,733 samples</div>
                <div className="text-slate-500">Quality-verified</div>
              </div>
              <div className="bg-blue-900/30 border border-blue-500/50 rounded p-2 text-center">
                <div className="text-2xl">üìä</div>
                <div className="text-blue-400 font-medium">OBD-II</div>
                <div className="text-slate-400">14 PIDs + DTCs</div>
                <div className="text-slate-500">Synthetic pairing</div>
              </div>
            </div>
          ),
        },
        {
          n: '1', title: 'Vibration Pre-training', type: 'physics', validation: 'new',
          content: (
            <div className="space-y-2 text-xs">
              <div className="grid grid-cols-3 gap-2">
                <div className="bg-orange-900/30 border border-orange-500/50 rounded p-2 text-center">
                  <div className="text-orange-400 font-semibold">Simulator</div>
                  <div className="text-slate-400">22 fault types</div>
                  <div className="text-slate-400">7 engine configs</div>
                </div>
                <div className="bg-green-900/30 border border-green-500/50 rounded p-2 text-center">
                  <div className="text-green-400 font-semibold">Encoder</div>
                  <div className="text-slate-400">CNN ‚Üí 256-dim</div>
                  <div className="text-slate-400">Spectrogram input</div>
                </div>
                <div className="bg-purple-900/30 border border-purple-500/50 rounded p-2 text-center">
                  <div className="text-purple-400 font-semibold">Result</div>
                  <div className="text-white font-bold">63.9%</div>
                  <div className="text-slate-400">(realistic physics)</div>
                </div>
              </div>
            </div>
          ),
        },
        {
          n: '2', title: 'Audio Feature Extraction', type: 'neural', validation: 'validated',
          content: (
            <div className="space-y-2 text-xs">
              <div className="grid grid-cols-3 gap-2">
                <div className="bg-cyan-900/30 border border-cyan-500/50 rounded p-2 text-center">
                  <div className="text-cyan-400 font-semibold">AST</div>
                  <div className="text-slate-400">768-dim</div>
                  <div className="text-slate-400">16kHz</div>
                </div>
                <div className="bg-pink-900/30 border border-pink-500/50 rounded p-2 text-center">
                  <div className="text-pink-400 font-semibold">CLAP</div>
                  <div className="text-slate-400">3072-dim (multi-scale)</div>
                  <div className="text-slate-400">48kHz</div>
                </div>
                <div className="bg-yellow-900/30 border border-yellow-500/50 rounded p-2 text-center">
                  <div className="text-yellow-400 font-semibold">Combined</div>
                  <div className="text-slate-400">3840-dim</div>
                  <div className="text-slate-400">‚Üí PCA 512</div>
                </div>
              </div>
            </div>
          ),
        },
        {
          n: '3', title: 'Classification & Anomaly', type: 'hybrid', validation: 'validated',
          content: (
            <div className="space-y-2 text-xs">
              <div className="grid grid-cols-2 gap-2">
                <div className="bg-green-900/30 border border-green-500/50 rounded p-2">
                  <div className="text-green-400 font-semibold">11-Class Classifier</div>
                  <div className="text-slate-400">SVM RBF + class weights</div>
                  <div className="text-white font-bold">52.4% accuracy</div>
                </div>
                <div className="bg-purple-900/30 border border-purple-500/50 rounded p-2">
                  <div className="text-purple-400 font-semibold">Anomaly Detection</div>
                  <div className="text-slate-400">AST+CLAP + Isolation Forest</div>
                  <div className="text-white font-bold">AUC = 0.777</div>
                </div>
              </div>
            </div>
          ),
        },
        {
          n: '4', title: 'Knowledge Graph Query', type: 'symbolic', validation: 'validated',
          content: (
            <div className="bg-slate-800 rounded p-2 text-xs">
              <div className="flex items-center justify-center gap-2 flex-wrap">
                <span className="bg-yellow-900/50 border border-yellow-500/50 rounded px-2 py-1 text-yellow-300">EvidenceVector</span>
                <span className="text-slate-500">‚Üí</span>
                <span className="bg-cyan-900/50 border border-cyan-500/50 rounded px-2 py-1 text-cyan-300">KG.query()</span>
                <span className="text-slate-500">‚Üí</span>
                <span className="bg-green-900/50 border border-green-500/50 rounded px-2 py-1 text-green-300">30 Fault Candidates</span>
              </div>
            </div>
          ),
        },
        {
          n: '5', title: 'Deductive Filtering', type: 'symbolic', validation: 'validated',
          content: (
            <div className="bg-slate-800 rounded p-2 text-xs">
              <div className="text-green-400 font-semibold mb-1">Hard Constraints (Physics & Logic)</div>
              <div className="grid grid-cols-2 gap-2">
                <div className="text-slate-400">‚Ä¢ Physics: RPM, Temp, Load, Onset</div>
                <div className="text-slate-400">‚Ä¢ System: Fuel Trims, DTC Logic</div>
              </div>
            </div>
          ),
        },
        {
          n: '6', title: 'Abductive Ranking', type: 'hybrid', validation: 'validated',
          content: (
            <div className="bg-slate-800 rounded p-2 text-xs">
              <div className="text-blue-400 font-semibold mb-1">Bayesian Logic + Reasoning</div>
              <div className="space-y-1">
                {[
                  { fault: 'Rod knock', score: '0.85', top: true },
                  { fault: 'Main bearing', score: '0.12', top: false },
                ].map((h, i) => (
                  <div key={i} className={`flex justify-between p-1 rounded ${h.top ? 'bg-blue-900/30' : 'bg-slate-900'}`}>
                    <span className={h.top ? 'text-white' : 'text-slate-400'}>{h.fault}</span>
                    <span className={h.top ? 'text-blue-300' : 'text-slate-500'}>{h.score}</span>
                  </div>
                ))}
              </div>
            </div>
          ),
        },
        {
          n: '7', title: 'Output', type: 'hybrid', validation: 'validated', llm: true,
          content: (
            <div className="bg-gradient-to-r from-slate-800 via-slate-900 to-pink-900/20 rounded p-3 border border-pink-500/50 text-xs">
              <div className="flex justify-between items-center mb-2">
                <span className="text-white font-bold">Rod Bearing Wear</span>
                <div className="flex items-center gap-2">
                  <span className="bg-blue-500 text-white text-xs font-bold px-2 py-0.5 rounded-full">72%</span>
                  <span className="text-pink-400 text-xs">‚ú® LLM</span>
                </div>
              </div>
              <div className="bg-pink-900/20 border border-pink-500/30 rounded p-2 text-pink-200 italic">
                "The knocking sound, combined with 2x order harmonics, indicates rod bearing clearance..."
              </div>
            </div>
          ),
        },
      ];

      return (
        <div className="space-y-2">
          {stages.map((s, i) => (
            <div key={i}>
              <div className={`rounded-lg border overflow-hidden ${s.llm ? 'bg-gradient-to-r from-slate-900/50 to-pink-900/10 border-pink-500/30' : 'bg-slate-900/50 border-slate-700'}`}>
                <div className="p-3">
                  <div className="flex items-center justify-between mb-2">
                    <div className="flex items-center gap-2">
                      <span className="bg-slate-700 text-slate-300 text-xs font-bold w-6 h-6 rounded flex items-center justify-center">{s.n}</span>
                      <span className="text-blue-400 text-sm font-semibold">{s.title}</span>
                      <LLMBadge enabled={s.llm} />
                    </div>
                    <div className="flex items-center gap-2">
                      <TypeBadge type={s.type} />
                      <ValidationBadge status={s.validation} />
                    </div>
                  </div>
                  {s.content}
                </div>
              </div>
              {i < stages.length - 1 && <Arrow />}
            </div>
          ))}
        </div>
      );
    };

    // Research Log
    const ResearchLog = () => {
      const items = [
        { stage: '1', q: 'Synthetic vibration as anchor modality?', status: 'resolved', answer: 'Yes. Physics-based ‚Üí unlimited data, deterministic fault signatures.' },
        { stage: '1', q: 'Journal bearing vs rolling element physics?', status: 'resolved', answer: 'CORRECTED: Engine bearings are plain journal, not ball bearings. Impacts at 15¬∞ after TDC.' },
        { stage: '1', q: 'Best vibration encoder accuracy?', status: 'resolved', answer: '81.9% (original), 63.9% (physics-corrected). Realistic = harder but better transfer.' },
        { stage: '2', q: 'Best audio foundation model combination?', status: 'resolved', answer: 'AST (768d) + CLAP multi-scale (3072d) = 3840d combined ‚Üí PCA 512 ‚Üí SVM' },
        { stage: '2', q: 'Audio classification accuracy ceiling?', status: 'resolved', answer: '52.4% on 11-class (quality-verified data). Healthy=80%, misfire=53%, rattle=50%.' },
        { stage: '2', q: 'Freesound data quality?', status: 'resolved', answer: 'Mixed. grind/squeal/clunk had >50% outliers. Removed via embedding-based verification.' },
        { stage: '2', q: 'Synthetic audio generation?', status: 'resolved', answer: 'FAILED. AudioLDM2 causes -1.4% accuracy due to domain shift. Do NOT use.' },
        { stage: '2', q: 'Anomaly detection AUC?', status: 'resolved', answer: '0.777 with AST+CLAP concatenation + Isolation Forest.' },
        { stage: '3', q: 'Two-stage pipeline (anomaly ‚Üí classify)?', status: 'resolved', answer: 'FAILED. 22.9% end-to-end (errors cascade). Use single 11-class model instead.' },
        { stage: '3', q: 'PANNs CNN14 value-add?', status: 'resolved', answer: '38.5% alone, no improvement when combined with AST+CLAP.' },
        { stage: '3', q: 'AudioMAE value-add?', status: 'resolved', answer: '31.8%. Self-supervised pretraining does NOT help for this task.' },
        { stage: '2b', q: '22 fault types coverage?', status: 'resolved', answer: 'Covers all OBD-undetectable faults: engine internal, accessory, turbo, drivetrain, exhaust.' },
        { stage: '2b', q: 'Operating scenarios needed?', status: 'resolved', answer: '12 scenarios: cold_start, acceleration, deceleration, idle_hunting, city_drive, highway_merge, etc.' },
        { stage: '5', q: 'E2E Accuracy?', status: 'resolved', answer: '84.2% Recall@3 achieved.' },
        { stage: '-', q: 'Next step: Transfer vibration ‚Üí audio?', status: 'open', answer: 'Planned: Fine-tune vibration encoder on real audio embeddings via shared space.' },
        { stage: '-', q: 'Improve weak classes (grind, squeal, clunk)?', status: 'open', answer: 'Need more high-quality real data. Freesound samples were too generic.' },
      ];

      return (
        <div className="space-y-2">
          {items.map((item, i) => (
            <div key={i} className={`rounded p-2 text-xs ${item.status === 'resolved' ? 'bg-green-900/20 border border-green-500/30' : 'bg-yellow-900/20 border border-yellow-500/30'}`}>
              <div className="flex items-start gap-2">
                <span className="bg-slate-700 text-slate-400 px-1.5 py-0.5 rounded text-xs">S{item.stage}</span>
                <div className="flex-1">
                  <div className={item.status === 'resolved' ? 'text-slate-400' : 'text-yellow-300'}>{item.q}</div>
                  {item.answer && <div className={item.status === 'resolved' ? 'text-green-400 mt-1' : 'text-yellow-400 mt-1'}>‚Üí {item.answer}</div>}
                </div>
                <span className={`px-1.5 py-0.5 rounded text-xs ${item.status === 'resolved' ? 'bg-green-500/20 text-green-400' : 'bg-yellow-500/20 text-yellow-400'}`}>
                  {item.status}
                </span>
              </div>
            </div>
          ))}
        </div>
      );
    };

    function App() {
      const [view, setView] = useState('executive');

      return (
        <div className="min-h-screen bg-gradient-to-br from-slate-950 to-slate-900 p-4">
          <h1 className="text-xl font-bold text-center mb-1 bg-gradient-to-r from-orange-400 via-cyan-400 to-purple-400 bg-clip-text text-transparent">
            Vehicle Diagnostic Pipeline v6.0
          </h1>
          <p className="text-center text-slate-500 text-xs mb-4">
            <span className="text-orange-400">Synthetic Vibration Pre-training</span> ‚Ä¢
            <span className="text-cyan-400"> 52.4% Audio (11-class)</span> ‚Ä¢
            <span className="text-purple-400"> 63.9% Vibration (22-class)</span> ‚Ä¢
            <span className="text-pink-400"> ‚ú® LLM</span>
          </p>

          {/* View Toggle */}
          <div className="flex justify-center gap-1 mb-4 flex-wrap">
            {[
              { key: 'executive', label: 'Overview' },
              { key: 'vibration', label: 'Vibration' },
              { key: 'audio', label: 'Audio' },
              { key: 'pipeline', label: 'Pipeline' },
              { key: 'research', label: 'Research Log' }
            ].map(v => (
              <button
                key={v.key}
                onClick={() => setView(v.key)}
                className={`px-3 py-1 rounded text-xs font-medium transition ${view === v.key ? 'bg-blue-500 text-white' : 'bg-slate-800 text-slate-400 hover:bg-slate-700'
                  }`}
              >
                {v.label}
              </button>
            ))}
          </div>

          {/* Validation Summary */}
          <div className="max-w-3xl mx-auto mb-4 flex justify-center gap-4 text-xs">
            <div className="flex items-center gap-1">
              <span className="text-green-400">‚óè</span>
              <span className="text-slate-400">8/9 validated</span>
            </div>
            <div className="flex items-center gap-1">
              <span className="text-purple-400">‚óè</span>
              <span className="text-slate-400">1/9 new (vibration pre-training)</span>
            </div>
          </div>

          <div className="max-w-3xl mx-auto">
            {view === 'executive' && <ExecutiveView />}
            {view === 'vibration' && <VibrationView />}
            {view === 'audio' && <AudioView />}
            {view === 'pipeline' && <PipelineView />}
            {view === 'research' && <ResearchLog />}
          </div>

          {/* Compact Legend */}
          <div className="max-w-3xl mx-auto mt-4 pt-3 border-t border-slate-800 flex justify-center gap-4 text-xs text-slate-500">
            <span><span className="text-purple-400">‚ñ†</span> Neural</span>
            <span><span className="text-green-400">‚ñ†</span> Symbolic</span>
            <span><span className="text-blue-400">‚ñ†</span> Hybrid</span>
            <span><span className="text-orange-400">‚ñ†</span> Physics</span>
            <span><span className="text-pink-400">‚ú®</span> LLM</span>
          </div>

          <div className="text-center text-xs text-slate-600 mt-3">
            v6.0 ‚Äî Synthetic Vibration Pre-training | Physics-Corrected | 22 Fault Types | Updated: 2026-01-28
          </div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>

</html>
